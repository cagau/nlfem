<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nonlocal FEM Code: /home/klar/Seafile/Promotion/projects/nlfem/src/Cassemble.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Nonlocal FEM Code
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Cassemble.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;queue&gt;</code><br />
<code>#include &lt;armadillo&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &quot;metis.h&quot;</code><br />
<code>#include &lt;Cassemble.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &quot;integration.h&quot;</code><br />
<code>#include &quot;mathhelpers.h&quot;</code><br />
<code>#include &quot;model.h&quot;</code><br />
<code>#include &quot;<a class="el" href="checks_8cpp_source.html">checks.cpp</a>&quot;</code><br />
</div>
<p><a href="Cassemble_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a77a91f9cb5a7d3ec9b15b15805a7dc4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cassemble_8cpp.html#a77a91f9cb5a7d3ec9b15b15805a7dc4d">lookup_configuration</a> (<a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;conf, int verbose=0)</td></tr>
<tr class="separator:a77a91f9cb5a7d3ec9b15b15805a7dc4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8a925f3dbe70f08cb39fad631ae206d"><td class="memItemLeft" align="right" valign="top"><a id="af8a925f3dbe70f08cb39fad631ae206d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>compute_f</b> (const <a class="el" href="structElementStruct.html">ElementType</a> &amp;aT, const <a class="el" href="structQuadratureStruct.html">QuadratureType</a> &amp;quadRule, const <a class="el" href="structMeshStruct.html">MeshType</a> &amp;mesh, double *termf)</td></tr>
<tr class="separator:af8a925f3dbe70f08cb39fad631ae206d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6176f7eadd2861c28afc7ec3404d0044"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cassemble_8cpp.html#a6176f7eadd2861c28afc7ec3404d0044">par_evaluateMass</a> (double *vd, const double *ud, long *Elements, const long *ElementLabels, const double *Verts, const long *VertexLabels, int K_Omega, int J, int nP, double *P, const double *dx, const int dim, const int outdim, const int is_DiscontinuousGalerkin)</td></tr>
<tr class="memdesc:a6176f7eadd2861c28afc7ec3404d0044"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the mass matrix v = Mu.  <a href="#a6176f7eadd2861c28afc7ec3404d0044">More...</a><br /></td></tr>
<tr class="separator:a6176f7eadd2861c28afc7ec3404d0044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf930d780ac0bd1dd72b210c170ec91"><td class="memItemLeft" align="right" valign="top"><a id="aeaf930d780ac0bd1dd72b210c170ec91"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>estimateNNZperRow</b> (const <a class="el" href="structMeshStruct.html">MeshType</a> &amp;mesh, const <a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;conf)</td></tr>
<tr class="separator:aeaf930d780ac0bd1dd72b210c170ec91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9a6bd734e93c5ec0df6705f0dc07ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cassemble_8cpp.html#add9a6bd734e93c5ec0df6705f0dc07ba">par_assemble</a> (const string compute, const string path_spAd, const string path_fd, const int K_Omega, const int K, const long *ptrTriangles, const long *ptrLabelTriangles, const double *ptrVerts, const long *ptrLabelVerts, const int nE, const int nE_Omega, const int nV, const int nV_Omega, const double *Px, const int nPx, const double *dx, const double *Py, const int nPy, const double *dy, const double sqdelta, const int is_DiscontinuousGalerkin, const int is_NeumannBoundary, const string str_model_kernel, const string str_model_f, const string str_integration_method_remote, const string str_integration_method_close, const int is_PlacePointOnCap, const int dim, const int outdim, const long *ptrZeta, const long nZeta, const double *Pg, const int degree, const double *dg, double maxDiameter, double fractional_s, int is_fullConnectedComponentSearch, int verbose)</td></tr>
<tr class="memdesc:add9a6bd734e93c5ec0df6705f0dc07ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallel assembly of nonlocal operator using a finite element approach. This function is a wrapper for the functions <a class="el" href="Cassemble_8cpp.html#a3bbd07ec6c5b6e2266b97b79e52240b0" title="Parallel assembly of nonlocal operator using a finite element approach. Kernel functions can be defin...">par_system()</a> and <a class="el" href="Cassemble_8cpp.html#af5d9ec675a5530d98e7e11f9686bee6c" title="Parallel assembly of forcing term. Forcing functions can be defined in model see model_f() for more i...">par_forcing()</a>. It allows to call the C++ functions from Cython without writing wrapper classes or structs.  <a href="#add9a6bd734e93c5ec0df6705f0dc07ba">More...</a><br /></td></tr>
<tr class="separator:add9a6bd734e93c5ec0df6705f0dc07ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bbd07ec6c5b6e2266b97b79e52240b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cassemble_8cpp.html#a3bbd07ec6c5b6e2266b97b79e52240b0">par_system</a> (<a class="el" href="structMeshStruct.html">MeshType</a> &amp;mesh, <a class="el" href="structQuadratureStruct.html">QuadratureType</a> &amp;quadRule, <a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;conf)</td></tr>
<tr class="memdesc:a3bbd07ec6c5b6e2266b97b79e52240b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallel assembly of nonlocal operator using a finite element approach. Kernel functions can be defined in <em>model</em> see model_kernel() for more information.  <a href="#a3bbd07ec6c5b6e2266b97b79e52240b0">More...</a><br /></td></tr>
<tr class="separator:a3bbd07ec6c5b6e2266b97b79e52240b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5d9ec675a5530d98e7e11f9686bee6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Cassemble_8cpp.html#af5d9ec675a5530d98e7e11f9686bee6c">par_forcing</a> (<a class="el" href="structMeshStruct.html">MeshType</a> &amp;mesh, <a class="el" href="structQuadratureStruct.html">QuadratureType</a> &amp;quadRule, <a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;conf)</td></tr>
<tr class="memdesc:af5d9ec675a5530d98e7e11f9686bee6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parallel assembly of forcing term. Forcing functions can be defined in <em>model</em> see model_f() for more information.  <a href="#af5d9ec675a5530d98e7e11f9686bee6c">More...</a><br /></td></tr>
<tr class="separator:af5d9ec675a5530d98e7e11f9686bee6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains assembly algorithm for nonlocal stiffnes matrix and forcing function.</p>
<dl class="section author"><dt>Author</dt><dd>Manuel Klar </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 25/08/20 </dd></dl>

<p class="definition">Definition in file <a class="el" href="Cassemble_8cpp_source.html">Cassemble.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a77a91f9cb5a7d3ec9b15b15805a7dc4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a91f9cb5a7d3ec9b15b15805a7dc4d">&#9670;&nbsp;</a></span>lookup_configuration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lookup_configuration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;&#160;</td>
          <td class="paramname"><em>conf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function looks up the configuration. It has to be updated whenever a new kernel, forcing function or integration routine is added in order to make the option available.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conf</td><td>ConfigurationType </td></tr>
    <tr><td class="paramname">verbose</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Cassemble_8cpp_source.html#l00028">28</a> of file <a class="el" href="Cassemble_8cpp_source.html">Cassemble.cpp</a>.</p>

</div>
</div>
<a id="add9a6bd734e93c5ec0df6705f0dc07ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9a6bd734e93c5ec0df6705f0dc07ba">&#9670;&nbsp;</a></span>par_assemble()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void par_assemble </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>compute</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>path_spAd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>path_fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>K_Omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>K</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>ptrTriangles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>ptrLabelTriangles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>ptrVerts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>ptrLabelVerts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nE_Omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nV_Omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Px</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nPx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Py</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nPy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sqdelta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_DiscontinuousGalerkin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_NeumannBoundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>str_model_kernel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>str_model_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>str_integration_method_remote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>str_integration_method_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_PlacePointOnCap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>ptrZeta</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nZeta</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Pg</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>degree</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dg</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxDiameter</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fractional_s</em> = <code>-1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_fullConnectedComponentSearch</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parallel assembly of nonlocal operator using a finite element approach. This function is a wrapper for the functions <a class="el" href="Cassemble_8cpp.html#a3bbd07ec6c5b6e2266b97b79e52240b0" title="Parallel assembly of nonlocal operator using a finite element approach. Kernel functions can be defin...">par_system()</a> and <a class="el" href="Cassemble_8cpp.html#af5d9ec675a5530d98e7e11f9686bee6c" title="Parallel assembly of forcing term. Forcing functions can be defined in model see model_f() for more i...">par_forcing()</a>. It allows to call the C++ functions from Cython without writing wrapper classes or structs. </p>
<p>Any 2-dimensional array is handed over by a pointer only. The expected shape of the input arrays is given in the parameter list where the underlying data is expected to be in C-contiguous (i.e. row-major) order. We denote the dimension of the domain by d. See <a class="el" href="Cassemble_8cpp.html#a3bbd07ec6c5b6e2266b97b79e52240b0" title="Parallel assembly of nonlocal operator using a finite element approach. Kernel functions can be defin...">par_system()</a> and <a class="el" href="Cassemble_8cpp.html#af5d9ec675a5530d98e7e11f9686bee6c" title="Parallel assembly of forcing term. Forcing functions can be defined in model see model_f() for more i...">par_forcing()</a> for mor details on the assembly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">compute</td><td>string "system", "forcing", "systemforcing". This string determines whether the stiffnes matrix, load or both should be computed. </td></tr>
    <tr><td class="paramname">path_spAd</td><td>Save path for sparse matrix (armadillo binary) </td></tr>
    <tr><td class="paramname">path_fd</td><td>Save path for forcing (armadillo binary) </td></tr>
    <tr><td class="paramname">K_Omega</td><td>Number of rows of the stiffness matrix A. Example: If you want to solve a scalar equation using continuous Galerkin basis functions then K_Omega is equal to the number of basisfunctions (nV_Omega) which are not part of the Dirichlet boundary. If your problem is not scalar as for example in peridynamics then K_Omega = nV_Omega*outdim. </td></tr>
    <tr><td class="paramname">K</td><td>Number of Columns of the stiffness matrix A </td></tr>
    <tr><td class="paramname">ptrTriangles</td><td><b>(nE, d+1)</b> Pointer to elements. Label 1 for elements in Omega, Label 2 for elements in OmegaI. </td></tr>
    <tr><td class="paramname">ptrLabelTriangles</td><td><b>(nE,)</b> Pointer to element labels </td></tr>
    <tr><td class="paramname">ptrVerts</td><td><b>(L, d)</b> Pointer to vertices </td></tr>
    <tr><td class="paramname">ptrLabelVerts</td><td>Pointer to vertex labels </td></tr>
    <tr><td class="paramname">nE</td><td>Number of elements </td></tr>
    <tr><td class="paramname">nE_Omega</td><td>Number of elements in Omega </td></tr>
    <tr><td class="paramname">nV</td><td>Number of vertices </td></tr>
    <tr><td class="paramname">nV_Omega</td><td>Number of vertices in Omega </td></tr>
    <tr><td class="paramname">Px</td><td><b>(nPx, d)</b> Pointer to quadrature points for the outer integral </td></tr>
    <tr><td class="paramname">nPx</td><td>Number of quadrature points in the outer integral </td></tr>
    <tr><td class="paramname">dx</td><td><b>(nPx,)</b> Pointer to quadrature weights of the outer integral </td></tr>
    <tr><td class="paramname">Py</td><td>Number of quadrature points in the inner integral </td></tr>
    <tr><td class="paramname">nPy</td><td><b>(nPy, d)</b> Pointer to quadrature points for the inner integral </td></tr>
    <tr><td class="paramname">dy</td><td><b>(nPx,)</b> Pointer to quadrature weights of the inner integral </td></tr>
    <tr><td class="paramname">sqdelta</td><td>Squared delta </td></tr>
    <tr><td class="paramname">is_DiscontinuousGalerkin</td><td>Switch for discontinuous Galerkin </td></tr>
    <tr><td class="paramname">is_NeumannBoundary</td><td>Switch of Neumann Boundary Conditions </td></tr>
    <tr><td class="paramname">str_model_kernel</td><td>Name of kernel </td></tr>
    <tr><td class="paramname">str_model_f</td><td>Name of right hand side </td></tr>
    <tr><td class="paramname">str_integration_method_remote</td><td>Name of integration method </td></tr>
    <tr><td class="paramname">is_PlacePointOnCap</td><td>Switch for withcaps parameter in retriangulation </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension of the domain </td></tr>
    <tr><td class="paramname">outdim</td><td>Dimension of the solution space (e.g. 1 for scalar problems, dim for linear elasticity) </td></tr>
    <tr><td class="paramname">ptrZeta</td><td>Pointer to overlap counter of decomposed Mesh (optional) </td></tr>
    <tr><td class="paramname">nZeta</td><td>Number of rows of Zeta </td></tr>
    <tr><td class="paramname">Pg</td><td><b>(nPg, dim^2)</b> Quadrature points for tensor Gauss quadrature (optional, needed for singular kernels). </td></tr>
    <tr><td class="paramname">nPg</td><td><b>(tensorGaussDegree^dim,)</b> Number of quadrature points. </td></tr>
    <tr><td class="paramname">dg</td><td><b>(nPg,)</b> Weights for tensor Gauss quadrature. </td></tr>
    <tr><td class="paramname">maxDiameter</td><td>Maximal diameter of finite elements (optional). Might increase speed of retriangulation if provided. </td></tr>
    <tr><td class="paramname">fractional_s</td><td>Degree of fractional kernel (d=2 only). Required for the correct choice of the integration routine. Default is s=-1.0, which corresponds to a kernel with no singularity. </td></tr>
    <tr><td class="paramname">verbose</td><td>switch for verbose mode. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Cassemble_8cpp_source.html#l00357">357</a> of file <a class="el" href="Cassemble_8cpp_source.html">Cassemble.cpp</a>.</p>

</div>
</div>
<a id="a6176f7eadd2861c28afc7ec3404d0044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6176f7eadd2861c28afc7ec3404d0044">&#9670;&nbsp;</a></span>par_evaluateMass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void par_evaluateMass </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>ud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname"><em>Elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>ElementLabels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>Verts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long *&#160;</td>
          <td class="paramname"><em>VertexLabels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>K_Omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outdim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_DiscontinuousGalerkin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the mass matrix v = Mu. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vd</td><td>Pointer to the first entry of the output vector. </td></tr>
    <tr><td class="paramname">ud</td><td>Pointer to the first entry of the input vector. </td></tr>
    <tr><td class="paramname">Elements</td><td>List of elements of a finite element triangulation (CSR-format, row major order). </td></tr>
    <tr><td class="paramname">ElementLabels</td><td>List of element Labels. </td></tr>
    <tr><td class="paramname">Verts</td><td>List of vertices (row major order). </td></tr>
    <tr><td class="paramname">VertexLabels</td><td>List of vertex Labels. </td></tr>
    <tr><td class="paramname">K_Omega</td><td>Number of rows and columns in M. Example: If you use continuous Galerkin basis functions and want to solve a scalar problem K_Omega = J. </td></tr>
    <tr><td class="paramname">J</td><td>Number of elements in the triangulation. </td></tr>
    <tr><td class="paramname">nP</td><td>Number of quadrature points in the outer integral </td></tr>
    <tr><td class="paramname">P</td><td><b>(nPx, d)</b> Pointer to quadrature points. </td></tr>
    <tr><td class="paramname">dx</td><td><b>(nPx,)</b> Pointer to quadrature weights. </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension of the domain Omega (2 or 3). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Cassemble_8cpp_source.html#l00163">163</a> of file <a class="el" href="Cassemble_8cpp_source.html">Cassemble.cpp</a>.</p>

</div>
</div>
<a id="af5d9ec675a5530d98e7e11f9686bee6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5d9ec675a5530d98e7e11f9686bee6c">&#9670;&nbsp;</a></span>par_forcing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void par_forcing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMeshStruct.html">MeshType</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuadratureStruct.html">QuadratureType</a> &amp;&#160;</td>
          <td class="paramname"><em>quadRule</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;&#160;</td>
          <td class="paramname"><em>conf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parallel assembly of forcing term. Forcing functions can be defined in <em>model</em> see model_f() for more information. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>The mesh is of type MeshType and contains all information about the finite element descretization. See <a class="el" href="structMeshStruct.html">MeshStruct</a> for more information. </td></tr>
    <tr><td class="paramname">quadRule</td><td>Quadrature rules for inner, and outer elements as well as for the singular kernels. </td></tr>
    <tr><td class="paramname">conf</td><td>General configuration, namely kernel, and forcing functions, as well as integration method. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Cassemble_8cpp_source.html#l00852">852</a> of file <a class="el" href="Cassemble_8cpp_source.html">Cassemble.cpp</a>.</p>

</div>
</div>
<a id="a3bbd07ec6c5b6e2266b97b79e52240b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bbd07ec6c5b6e2266b97b79e52240b0">&#9670;&nbsp;</a></span>par_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void par_system </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMeshStruct.html">MeshType</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuadratureStruct.html">QuadratureType</a> &amp;&#160;</td>
          <td class="paramname"><em>quadRule</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structConfigurationStruct.html">ConfigurationType</a> &amp;&#160;</td>
          <td class="paramname"><em>conf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parallel assembly of nonlocal operator using a finite element approach. Kernel functions can be defined in <em>model</em> see model_kernel() for more information. </p>
<p>This function assembles the stiffness matrix corresponding to the operator</p>
<ul>
<li><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathcal{L}(\mathbf{u})(\mathbf{x}) = p.v. \int_{B_{\delta}(\mathbf{x}) \cap \widetilde{\Omega}}(\mathbf{C}_\delta(\mathbf{x}, \mathbf{y}) \mathbf{u}(\mathbf{x}) - \mathbf{C}_\delta(\mathbf{y}, \mathbf{x})\mathbf{u}(\mathbf{y})) d\mathbf{y}. \]" src="form_25.png"/>
</p>
</li>
</ul>
<p>It traverses all elements aT with element Label != 0 and adds up their contribution to the global stiffness matrix. The integration starts with the domain aT x aT and then proceeds with the neighbouring elements of aT in the mesh until the interaction domain is exceeded. For each pair aT, bT an integration routine (options are e.g. <a class="el" href="integration_8cpp.html#a5c489e256e2ba50b842c2452b6589780" title="This integration routines uses method_retriangulate() to truncate the inner domain bT...">integrate_retriangulate()</a>, <a class="el" href="integration_8cpp.html#a1f3d43743b6fb32a3c702ae2923131a9" title=". This integration routines uses method_baryCenter() to truncate the inner domain bT...">integrate_baryCenter()</a>, <a class="el" href="integration_8cpp.html#ab80cfb23f67be48dbd5daebfc3822157" title="This integration routines uses method_retriangulate() to truncate the outer domain bT...">integrate_baryCenterRT()</a>, ...) is called. If it all computed integrals are 0 the elements are considered as non-interacting. The integrals, and the interaction sets again depend on the truncation routines, which are called inside integrate(). This approach allows to define interaction sets directly in the truncation routines. The code then automatically finds the interacting elements bT without traversing all of them. This approach requires setting up the dual graph of the mesh which is to be found in mesh.neighbours.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Ad,Pointer</td><td>to map&lt;unsigned long, double&gt; which is used to store matrix values. This map is shared between all threads and the value updates happen in critical sections. This makes sense because in case of nonlocal operators Ad can turn out to be very large. Storing Ad separately in separate threads and finally merging the different maps results in a significant overhead. </td></tr>
    <tr><td class="paramname">mesh</td><td>The mesh is of type MeshType and contains all information about the finite element descretization. See <a class="el" href="structMeshStruct.html">MeshStruct</a> for more information. </td></tr>
    <tr><td class="paramname">quadRule</td><td>Quadrature rules for inner, and outer elements as well as for the singular kernels. </td></tr>
    <tr><td class="paramname">conf</td><td>General configuration, namely kernel, and forcing functions, as well as integration method. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="Cassemble_8cpp_source.html#l00460">460</a> of file <a class="el" href="Cassemble_8cpp_source.html">Cassemble.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
