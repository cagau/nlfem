

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Nonlocal Assembly’s doc &mdash; Nonlocal Assembly  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> Nonlocal Assembly
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Nonlocal Assembly’s doc</a><ul>
<li><a class="reference internal" href="#mesh-triangle-and-integrator-class">Mesh, Triangle and Integrator Class</a></li>
<li><a class="reference internal" href="#module-aux">Helper modules</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Nonlocal Assembly</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Nonlocal Assembly’s doc</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nonlocal-assembly-s-doc">
<h1>Nonlocal Assembly’s doc<a class="headerlink" href="#nonlocal-assembly-s-doc" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="mesh-triangle-and-integrator-class">
<h2>Mesh, Triangle and Integrator Class<a class="headerlink" href="#mesh-triangle-and-integrator-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nlocal.clsMesh">
<em class="property">class </em><code class="sig-prename descclassname">nlocal.</code><code class="sig-name descname">clsMesh</code><span class="sig-paren">(</span><em class="sig-param">mshfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Mesh Class</strong></p>
<p>Let <img class="math" src="_images/math/52ddc0cde6d632f631533173562fe3ca375b1f32.png" alt="K"/> be the number of basis functions and <img class="math" src="_images/math/32c06f8c59d4bd3d13eedea7765a8a74a11f2383.png" alt="J"/> the number of finite elements. The ordering of the vertices
V is such that the first <img class="math" src="_images/math/5efa725f25d308e647146a48ae71a6e07c6ce79f.png" alt="K_{\Omega}"/> vertices lie in the interior of <img class="math" src="_images/math/8b79605e88e6ebb950c74a1319cdc046dae2069c.png" alt="\Omega"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> – nd.array, real, shape (K, 2) List of vertices in the 2D plane</p></li>
<li><p><strong>T</strong> – nd.array, int, shape (J, 3) List of indices mapping an index Tdx to 3 corresponding vertices of V.</p></li>
<li><p><strong>K</strong> – Number of basis functions.</p></li>
<li><p><strong>K_Omega</strong> – Number if basis functions in the interior of <img class="math" src="_images/math/8b79605e88e6ebb950c74a1319cdc046dae2069c.png" alt="\Omega"/>.</p></li>
<li><p><strong>J</strong> – Number of finite elements <img class="math" src="_images/math/8b79605e88e6ebb950c74a1319cdc046dae2069c.png" alt="\Omega"/>.</p></li>
<li><p><strong>J_Omega</strong> – Number of finite elements in</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="nlocal.clsMesh.Vdx">
<code class="sig-name descname">Adx</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.Vdx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh.Vdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indices of the nodes of Triangle with index Tdx as index w.r.t to
the array Verts (Adx)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Tdx</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Adx, nd.array, int, shape (3,) The indices of the nodes w.r.t Verts.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsMesh.Vdx_inOmega">
<code class="sig-name descname">Adx_inOmega</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.Vdx_inOmega"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh.Vdx_inOmega" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the indices of the nodes of Triangle with index Tdx
as index w.r.t the triangle (dx_inOmega) and as index w.r.t to
the array Verts (Adx)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Tdx</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dx_inOmega, nd.array, int, shape (3,) The indices of the nodes w.r.t T.E which lie in Omega.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Adx, nd.array, int, shape (3,) The indices of the nodes w.r.t Verts which lie in Omega.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsMesh.neighbor">
<code class="sig-name descname">neighbor</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.neighbor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh.neighbor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of indices of neighbours of Tdx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Tdx</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsMesh.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em>, <em class="sig-param">is_plotmsh=False</em>, <em class="sig-param">pdfname='meshplot'</em>, <em class="sig-param">delta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot triangle with index Tdx.</p>
<blockquote>
<div><ul class="simple">
<li><p>Link to matplotlib markers: <a class="reference external" href="https://matplotlib.org/3.1.0/api/markers_api.html">https://matplotlib.org/3.1.0/api/markers_api.html</a></p></li>
<li><p>Link to plt.scatter snippet: <a class="reference external" href="https://stackoverflow.com/questions/14827650/pyplot-scatter-plot-marker-size">https://stackoverflow.com/questions/14827650/pyplot-scatter-plot-marker-size</a></p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Tdx</strong> – int or list of int, Index of Triangle or list of indices of Triangle.</p></li>
<li><p><strong>is_plotmsh</strong> – bool, default=False Switch for surrounding FEM-Mesh.</p></li>
<li><p><strong>pdfname</strong> – str Name of output pdf.</p></li>
<li><p><strong>delta</strong> – optional, Interaction radius. A <img class="math" src="_images/math/dc087f78b39c7a4b25b63ee0c21729bc4cb4f54c.png" alt="\ell_2"/>-circle will be drawn to show its size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsMesh.prepare">
<code class="sig-name descname">prepare</code><span class="sig-paren">(</span><em class="sig-param">Verts</em>, <em class="sig-param">Lines</em>, <em class="sig-param">Triangles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare mesh from Verts, Lines and Triangles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Verts</strong> – List of Vertices</p></li>
<li><p><strong>Lines</strong> – List of Lines</p></li>
<li><p><strong>Triangles</strong> – List of Triangles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Verts, Triangles, K, K_Omega, J, J_Omega</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsMesh.read_mesh">
<code class="sig-name descname">read_mesh</code><span class="sig-paren">(</span><em class="sig-param">mshfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.read_mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsMesh.read_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>meshfile = .msh - file genrated by gmsh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mshfile</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Verts, Lines, Triangles</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nlocal.clsTriangle">
<em class="property">class </em><code class="sig-prename descclassname">nlocal.</code><code class="sig-name descname">clsTriangle</code><span class="sig-paren">(</span><em class="sig-param">E</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsTriangle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsTriangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Triangle Classe</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>E</strong> – nd.array, real, shape (3,2). Physical nodes of Triangle.</p>
</dd>
</dl>
<dl class="method">
<dt id="nlocal.clsTriangle.absDet">
<code class="sig-name descname">absDet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsTriangle.absDet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsTriangle.absDet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nlocal.clsTriangle.baryCenter">
<code class="sig-name descname">baryCenter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsTriangle.baryCenter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsTriangle.baryCenter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nlocal.clsTriangle.toPhys">
<code class="sig-name descname">toPhys</code><span class="sig-paren">(</span><em class="sig-param">P</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsTriangle.toPhys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsTriangle.toPhys" title="Permalink to this definition">¶</a></dt>
<dd><p>Push reference points P to physical domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>P</strong> – nd.array, real, shape (2, n). Reference points, e.g. quadrature points of the reference element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nd.array, real, shape (2, n). Physical points.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nlocal.clsInt">
<em class="property">class </em><code class="sig-prename descclassname">nlocal.</code><code class="sig-name descname">clsInt</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">weights</em>, <em class="sig-param">delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsInt" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Integrator Class</strong></p>
<p>Contains the formulas, quadrature rule and functions fPhys and kerPhys.
The rule P, weights and delta are handed over when the object is constructed.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>psi</strong> – Values of basis functions for given rule P.</p>
</dd>
</dl>
<dl class="method">
<dt id="nlocal.clsInt.A">
<code class="sig-name descname">A</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">is_allInteract=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.A"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsInt.A" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the local and nonlocal terms of the integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – int. Index of vertex to find the correct reference basis function.</p></li>
<li><p><strong>b</strong> – int. Index of vertex to find the correct reference basis function.</p></li>
<li><p><strong>aT</strong> – Triangle, Triangle a.</p></li>
<li><p><strong>bT</strong> – Triangle, Triangle b.</p></li>
<li><p><strong>is_allInteract</strong> – bool. True if all points in aT interact with all points in bT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsInt.f">
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">aBdx_O</em>, <em class="sig-param">aT</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsInt.f" title="Permalink to this definition">¶</a></dt>
<dd><p>Assembles the right side f.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aBdx_O</strong> – tupel of int, i=0,1,2. Index of reference basis functions which lie in Omega.</p></li>
<li><p><strong>aT</strong> – Triangle. Triangle to intgrate over.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Integral.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsInt.fPhys">
<code class="sig-name descname">fPhys</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.fPhys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsInt.fPhys" title="Permalink to this definition">¶</a></dt>
<dd><p>Right side of the equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – nd.array, real, shape (2,). Physical point in the 2D plane</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>real</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="nlocal.clsInt.kernelPhys">
<code class="sig-name descname">kernelPhys</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">Tx</em>, <em class="sig-param">Ty</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.kernelPhys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nlocal.clsInt.kernelPhys" title="Permalink to this definition">¶</a></dt>
<dd><p>Constant integration kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> – ndarray, real, shape (2, n). Reference points for integration.</p></li>
<li><p><strong>Tx</strong> – Triangle. Triangle of x-Component.</p></li>
<li><p><strong>Ty</strong> – Triangle. Triangle of y-Component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>real. Evaluates the kernel on the full grid.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-aux">
<span id="helper-modules"></span><h2>Helper modules<a class="headerlink" href="#module-aux" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="aux.filename">
<code class="sig-prename descclassname">aux.</code><code class="sig-name descname">filename</code><span class="sig-paren">(</span><em class="sig-param">mesh_name</em>, <em class="sig-param">delta</em>, <em class="sig-param">Tstmp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aux.html#filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aux.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates filename for given input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh_name</strong> – Name of mesh, e.g. “medium”.</p></li>
<li><p><strong>delta</strong> – Interaction radius.</p></li>
<li><p><strong>Tstmp</strong> – bool, If True a timestamp will computed, otherwise it is set to “”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of string. Tstmp, filename</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="aux.timestamp">
<code class="sig-prename descclassname">aux.</code><code class="sig-name descname">timestamp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aux.html#timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aux.timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns current timestamp as string.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string, format %m%d_%H-%M-%S</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-nbhd"></span><dl class="function">
<dt id="nbhd.MinNbhd_l2Bary">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">MinNbhd_l2Bary</code><span class="sig-paren">(</span><em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">delta</em>, <em class="sig-param">v=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#MinNbhd_l2Bary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.MinNbhd_l2Bary" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether two triangles interact w.r.t <img class="math" src="_images/math/b1ff7649ab6c2272ed4d0b01504afd2e352de0a9.png" alt="L_{2}"/>-ball of size delta.
Returns an array of boolen values. Compares the barycenter of bT with the vertices of Ea.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aT</strong> – clsTriangle, Triangle a</p></li>
<li><p><strong>bT</strong> – clsTriangle, Triangle b</p></li>
<li><p><strong>delta</strong> – Size of L-2 ball</p></li>
<li><p><strong>v</strong> – Verbose mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray, bool, shape (3,) Entry i is True if Ea[i] and the barycenter of Eb interact.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="nbhd.MinNbhdfull_l2">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">MinNbhdfull_l2</code><span class="sig-paren">(</span><em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">delta</em>, <em class="sig-param">v=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#MinNbhdfull_l2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.MinNbhdfull_l2" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether two triangles interact w.r.t <img class="math" src="_images/math/b1ff7649ab6c2272ed4d0b01504afd2e352de0a9.png" alt="L_{2}"/>-ball of size delta.
Returns an array of boolen values. Compares all vertices of aT with all vertices of bT.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aT</strong> – clsTriangle, Triangle a</p></li>
<li><p><strong>bT</strong> – clsTriangle, Triangle b</p></li>
<li><p><strong>delta</strong> – Size of L-2 ball</p></li>
<li><p><strong>v</strong> – Verbose mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ndarray, bool, shape (3,3) Entry i,j is True if Ea[i] and Eb[j] interact.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="nbhd.S_infty">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">S_infty</code><span class="sig-paren">(</span><em class="sig-param">E</em>, <em class="sig-param">delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#S_infty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.S_infty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the corners of the <img class="math" src="_images/math/3591460d5534594833a7a89083b7f250f2320a77.png" alt="\delta - L_{\infty}"/>-Box around a Triangle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> – nd.array, real, shape (2,3) Vertices of the triangle</p></li>
<li><p><strong>delta</strong> – real, Size of the L-infinity box</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nd.array, real, shape (2,12) Corners of $B$</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="nbhd.inNbhd">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">inNbhd</code><span class="sig-paren">(</span><em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">delta</em>, <em class="sig-param">method='Ml2Bary'</em>, <em class="sig-param">v=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#inNbhd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.inNbhd" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the other inNbhd-functions.</p>
<blockquote>
<div><ul class="simple">
<li><p>The options <em>inf, lsBary</em> return a boolean value.</p></li>
<li><p>The options <em>Ml2Bary, Mfulll2</em> return a matrix of boolean values.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aT</strong> – clsTriangle, Triangle a</p></li>
<li><p><strong>bT</strong> – clsTriangle, Triangle b</p></li>
<li><p><strong>delta</strong> – real, Interaction Radius</p></li>
<li><p><strong>method</strong> – str, default=”l2”. Norm w.r.t which the Ball is constructed. Options inf, l2Bary, Ml2Bary, Mfulll2</p></li>
<li><p><strong>v</strong> – bool, Verbose switch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="nbhd.inNbhd_inf">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">inNbhd_inf</code><span class="sig-paren">(</span><em class="sig-param">Ea</em>, <em class="sig-param">Eb</em>, <em class="sig-param">delta</em>, <em class="sig-param">v=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#inNbhd_inf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.inNbhd_inf" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether two triangles interact w.r.t <img class="math" src="_images/math/211d6c557bea42799dc4b0299581e58ce47cc54f.png" alt="L_{\infty}"/>-ball of size delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aT</strong> – clsTriangle, Triangle a</p></li>
<li><p><strong>bT</strong> – clsTriangle, Triangle b</p></li>
<li><p><strong>delta</strong> – Size of L-infinity ball</p></li>
<li><p><strong>v</strong> – Verbose mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool True if Ea and Eb interact.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="nbhd.inNbhd_l2Bary">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">inNbhd_l2Bary</code><span class="sig-paren">(</span><em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">delta</em>, <em class="sig-param">v=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#inNbhd_l2Bary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.inNbhd_l2Bary" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether two triangles interact w.r.t <img class="math" src="_images/math/b1ff7649ab6c2272ed4d0b01504afd2e352de0a9.png" alt="L_{2}"/>-ball of size delta.
To that end, the function compares the barycenters of the triangles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aT</strong> – clsTriangle, Triangle a</p></li>
<li><p><strong>bT</strong> – clsTriangle, Triangle b</p></li>
<li><p><strong>delta</strong> – Size of L-2 ball</p></li>
<li><p><strong>v</strong> – Verbose mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool True if Ea and Eb interact.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="nbhd.xinNbhd">
<code class="sig-prename descclassname">nbhd.</code><code class="sig-name descname">xinNbhd</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nbhd.html#xinNbhd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nbhd.xinNbhd" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests whether a reference point p in Triangle a interacts
with triangle b w.r.t. <img class="math" src="_images/math/fcd0c45a70da7d2399b3fb666759b02c5edd251e.png" alt="L_2"/>-ball of radius delta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> – ndarray, real, shape (2,m) Point in the reference triangle.</p></li>
<li><p><strong>aT</strong> – clsTriangle Triangle a</p></li>
<li><p><strong>bT</strong> – clsTriangle Triangle b</p></li>
<li><p><strong>delta</strong> – real Radius of L2-Ball</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool True if the triangles interact.</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-nlocal"></span><dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">nlocal.</code><code class="sig-name descname">clsInt</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">weights</em>, <em class="sig-param">delta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt"><span class="viewcode-link">[source]</span></a></dt>
<dd><p><strong>Integrator Class</strong></p>
<p>Contains the formulas, quadrature rule and functions fPhys and kerPhys.
The rule P, weights and delta are handed over when the object is constructed.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>psi</strong> – Values of basis functions for given rule P.</p>
</dd>
</dl>
<dl class="method">
<dt>
<code class="sig-name descname">A</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">aT</em>, <em class="sig-param">bT</em>, <em class="sig-param">is_allInteract=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.A"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the local and nonlocal terms of the integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – int. Index of vertex to find the correct reference basis function.</p></li>
<li><p><strong>b</strong> – int. Index of vertex to find the correct reference basis function.</p></li>
<li><p><strong>aT</strong> – Triangle, Triangle a.</p></li>
<li><p><strong>bT</strong> – Triangle, Triangle b.</p></li>
<li><p><strong>is_allInteract</strong> – bool. True if all points in aT interact with all points in bT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">f</code><span class="sig-paren">(</span><em class="sig-param">aBdx_O</em>, <em class="sig-param">aT</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.f"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Assembles the right side f.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aBdx_O</strong> – tupel of int, i=0,1,2. Index of reference basis functions which lie in Omega.</p></li>
<li><p><strong>aT</strong> – Triangle. Triangle to intgrate over.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Integral.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">fPhys</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.fPhys"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Right side of the equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – nd.array, real, shape (2,). Physical point in the 2D plane</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>real</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">kernelPhys</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">Tx</em>, <em class="sig-param">Ty</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsInt.kernelPhys"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Constant integration kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> – ndarray, real, shape (2, n). Reference points for integration.</p></li>
<li><p><strong>Tx</strong> – Triangle. Triangle of x-Component.</p></li>
<li><p><strong>Ty</strong> – Triangle. Triangle of y-Component.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>real. Evaluates the kernel on the full grid.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">nlocal.</code><code class="sig-name descname">clsMesh</code><span class="sig-paren">(</span><em class="sig-param">mshfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p><strong>Mesh Class</strong></p>
<p>Let <img class="math" src="_images/math/52ddc0cde6d632f631533173562fe3ca375b1f32.png" alt="K"/> be the number of basis functions and <img class="math" src="_images/math/32c06f8c59d4bd3d13eedea7765a8a74a11f2383.png" alt="J"/> the number of finite elements. The ordering of the vertices
V is such that the first <img class="math" src="_images/math/5efa725f25d308e647146a48ae71a6e07c6ce79f.png" alt="K_{\Omega}"/> vertices lie in the interior of <img class="math" src="_images/math/8b79605e88e6ebb950c74a1319cdc046dae2069c.png" alt="\Omega"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> – nd.array, real, shape (K, 2) List of vertices in the 2D plane</p></li>
<li><p><strong>T</strong> – nd.array, int, shape (J, 3) List of indices mapping an index Tdx to 3 corresponding vertices of V.</p></li>
<li><p><strong>K</strong> – Number of basis functions.</p></li>
<li><p><strong>K_Omega</strong> – Number if basis functions in the interior of <img class="math" src="_images/math/8b79605e88e6ebb950c74a1319cdc046dae2069c.png" alt="\Omega"/>.</p></li>
<li><p><strong>J</strong> – Number of finite elements <img class="math" src="_images/math/8b79605e88e6ebb950c74a1319cdc046dae2069c.png" alt="\Omega"/>.</p></li>
<li><p><strong>J_Omega</strong> – Number of finite elements in</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt>
<code class="sig-name descname">Adx</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.Vdx"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the indices of the nodes of Triangle with index Tdx as index w.r.t to
the array Verts (Adx)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Tdx</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Adx, nd.array, int, shape (3,) The indices of the nodes w.r.t Verts.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">Adx_inOmega</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.Vdx_inOmega"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns the indices of the nodes of Triangle with index Tdx
as index w.r.t the triangle (dx_inOmega) and as index w.r.t to
the array Verts (Adx)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Tdx</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dx_inOmega, nd.array, int, shape (3,) The indices of the nodes w.r.t T.E which lie in Omega.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Adx, nd.array, int, shape (3,) The indices of the nodes w.r.t Verts which lie in Omega.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">neighbor</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.neighbor"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Return list of indices of neighbours of Tdx.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Tdx</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">Tdx</em>, <em class="sig-param">is_plotmsh=False</em>, <em class="sig-param">pdfname='meshplot'</em>, <em class="sig-param">delta=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.plot"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Plot triangle with index Tdx.</p>
<blockquote>
<div><ul class="simple">
<li><p>Link to matplotlib markers: <a class="reference external" href="https://matplotlib.org/3.1.0/api/markers_api.html">https://matplotlib.org/3.1.0/api/markers_api.html</a></p></li>
<li><p>Link to plt.scatter snippet: <a class="reference external" href="https://stackoverflow.com/questions/14827650/pyplot-scatter-plot-marker-size">https://stackoverflow.com/questions/14827650/pyplot-scatter-plot-marker-size</a></p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Tdx</strong> – int or list of int, Index of Triangle or list of indices of Triangle.</p></li>
<li><p><strong>is_plotmsh</strong> – bool, default=False Switch for surrounding FEM-Mesh.</p></li>
<li><p><strong>pdfname</strong> – str Name of output pdf.</p></li>
<li><p><strong>delta</strong> – optional, Interaction radius. A <img class="math" src="_images/math/dc087f78b39c7a4b25b63ee0c21729bc4cb4f54c.png" alt="\ell_2"/>-circle will be drawn to show its size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">prepare</code><span class="sig-paren">(</span><em class="sig-param">Verts</em>, <em class="sig-param">Lines</em>, <em class="sig-param">Triangles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.prepare"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Prepare mesh from Verts, Lines and Triangles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Verts</strong> – List of Vertices</p></li>
<li><p><strong>Lines</strong> – List of Lines</p></li>
<li><p><strong>Triangles</strong> – List of Triangles</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Verts, Triangles, K, K_Omega, J, J_Omega</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">read_mesh</code><span class="sig-paren">(</span><em class="sig-param">mshfile</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsMesh.read_mesh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>meshfile = .msh - file genrated by gmsh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mshfile</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Verts, Lines, Triangles</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">nlocal.</code><code class="sig-name descname">clsTriangle</code><span class="sig-paren">(</span><em class="sig-param">E</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsTriangle"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Triangle Classe</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>E</strong> – nd.array, real, shape (3,2). Physical nodes of Triangle.</p>
</dd>
</dl>
<dl class="method">
<dt>
<code class="sig-name descname">toPhys</code><span class="sig-paren">(</span><em class="sig-param">P</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nlocal.html#clsTriangle.toPhys"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Push reference points P to physical domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>P</strong> – nd.array, real, shape (2, n). Reference points, e.g. quadrature points of the reference element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nd.array, real, shape (2, n). Physical points.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h2>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Christian Vollmann, Manuel Klar

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>